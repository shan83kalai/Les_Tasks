package ltd.kalai.les.assignments2

import ltd.kalai.les.assignments2.JsonProcessingUtils.*

import java.util.concurrent.ConcurrentHashMap
import scala.jdk.CollectionConverters.*

object LargeJsonProcessor {

  def main(args: Array[String]): Unit = {
    val filePath = "/Users/shan/Les/Assignments_2/large_events.json"

    val dataMap = new ConcurrentHashMap[Int, ConcurrentHashMap[String, String]]()

    val startTime = System.currentTimeMillis()

    // Use the utility function
    processJsonFile(filePath, dataMap, processEvent)

    val endTime = System.currentTimeMillis()

    val timeTaken = endTime - startTime

    println(s"Processing started at: $startTime ms")
    println(s"Processing ended at: $endTime ms")
    println(s"Total time taken: $timeTaken ms")

    println(s"Processed data size: ${dataMap.size()}")
    dataMap.asScala.take(5).foreach { case (objectId, attributes) =>
      println(s"Object ID: $objectId, Attributes: ${attributes.asScala}")
    }
  }

}

//  Processing started at: 1737248572145 ms
//  Processing ended at: 1737277803235 ms
//  Total time taken: 29231090 ms
//  Processed data size: 1000000
//  Object ID: 1, Attributes: Map(attr_66 -> 895, attr_67 -> 3137, attr_64 -> 6379, attr_65 -> 4537, attr_62 -> 9210, attr_63 -> 5895, attr_60 -> 377, attr_61 -> 3465, attr_68 -> 6657, attr_69 -> 3337, attr_70 -> 8200, attr_77 -> 3303, attr_78 -> 4597, attr_75 -> 4391, attr_76 -> 6242, attr_73 -> 4474, attr_74 -> 9036, attr_71 -> 9315, attr_72 -> 249, attr_79 -> 991, attr_44 -> 148, attr_45 -> 1932, attr_42 -> 5877, attr_43 -> 5398, attr_40 -> 91, attr_41 -> 929, attr_48 -> 3419, attr_49 -> 7504, attr_46 -> 3123, attr_47 -> 8504, attr_55 -> 6580, attr_56 -> 373, attr_53 -> 3297, attr_54 -> 3644, attr_51 -> 2385, attr_52 -> 7893, attr_50 -> 2362, attr_9 -> 1305, attr_59 -> 951, attr_8 -> 158, attr_7 -> 8443, attr_57 -> 3247, attr_6 -> 5937, attr_58 -> 6572, attr_5 -> 5800, attr_4 -> 6889, attr_3 -> 8355, attr_2 -> 5471, attr_1 -> 5253, attr_0 -> 4789, attr_22 -> 6678, attr_23 -> 1480, attr_20 -> 2710, attr_21 -> 745, attr_28 -> 5937, attr_29 -> 6233, attr_26 -> 8132, attr_27 -> 3401, attr_24 -> 8013, attr_25 -> 8108, attr_33 -> 8794, attr_34 -> 9597, attr_31 -> 5824, attr_32 -> 4183, attr_30 -> 7060, attr_39 -> 7791, attr_37 -> 5120, attr_38 -> 9905, attr_35 -> 7248, attr_36 -> 7046, attr_80 -> 5922, attr_81 -> 9001, attr_88 -> 2048, attr_89 -> 3067, attr_86 -> 3560, attr_87 -> 1868, attr_84 -> 7471, attr_85 -> 6873, attr_82 -> 194, attr_83 -> 6010, attr_91 -> 4279, attr_92 -> 8162, attr_90 -> 5352, attr_11 -> 331, attr_99 -> 6730, attr_12 -> 2953, attr_97 -> 9138, attr_98 -> 8526, attr_10 -> 3987, attr_95 -> 4037, attr_96 -> 6745, attr_93 -> 1064, attr_94 -> 1024, attr_19 -> 3984, attr_17 -> 697, attr_18 -> 7000, attr_15 -> 3578, attr_16 -> 986, attr_13 -> 5753, attr_14 -> 2478)
//  Object ID: 2, Attributes: Map(attr_66 -> 6493, attr_67 -> 8898, attr_64 -> 3100, attr_65 -> 7473, attr_62 -> 2529, attr_63 -> 8038, attr_60 -> 5473, attr_61 -> 8525, attr_68 -> 6048, attr_69 -> 2412, attr_70 -> 9760, attr_77 -> 2486, attr_78 -> 2045, attr_75 -> 4963, attr_76 -> 6908, attr_73 -> 8579, attr_74 -> 3752, attr_71 -> 7457, attr_79 -> 9744, attr_44 -> 7844, attr_45 -> 6784, attr_42 -> 7646, attr_43 -> 7642, attr_40 -> 506, attr_41 -> 5183, attr_48 -> 1116, attr_49 -> 1092, attr_46 -> 5843, attr_47 -> 7058, attr_55 -> 7079, attr_56 -> 470, attr_53 -> 9149, attr_54 -> 2391, attr_51 -> 7616, attr_52 -> 6295, attr_50 -> 4773, attr_9 -> 2252, attr_59 -> 3945, attr_8 -> 7969, attr_7 -> 7191, attr_57 -> 4463, attr_58 -> 2717, attr_6 -> 9158, attr_5 -> 7569, attr_4 -> 7863, attr_3 -> 8022, attr_2 -> 6436, attr_1 -> 8747, attr_0 -> 4459, attr_22 -> 1926, attr_23 -> 2524, attr_20 -> 9216, attr_21 -> 8260, attr_28 -> 7826, attr_29 -> 6005, attr_26 -> 2835, attr_27 -> 6155, attr_24 -> 8473, attr_25 -> 4686, attr_33 -> 3456, attr_34 -> 7855, attr_31 -> 2161, attr_32 -> 7239, attr_30 -> 4089, attr_39 -> 1409, attr_37 -> 2005, attr_38 -> 8113, attr_35 -> 6667, attr_36 -> 1379, attr_80 -> 1080, attr_81 -> 139, attr_88 -> 5890, attr_89 -> 6387, attr_86 -> 2544, attr_87 -> 6902, attr_84 -> 2286, attr_85 -> 9092, attr_82 -> 3548, attr_83 -> 5503, attr_91 -> 4837, attr_92 -> 9027, attr_90 -> 8805, attr_99 -> 7765, attr_11 -> 1140, attr_12 -> 6841, attr_97 -> 9309, attr_98 -> 9440, attr_10 -> 2976, attr_95 -> 1237, attr_96 -> 9468, attr_93 -> 5064, attr_94 -> 5791, attr_19 -> 6265, attr_17 -> 7710, attr_18 -> 2317, attr_15 -> 7427, attr_16 -> 8991, attr_13 -> 7945, attr_14 -> 3394)
//  Object ID: 3, Attributes: Map(attr_66 -> 3, attr_67 -> 5264, attr_64 -> 7398, attr_65 -> 3738, attr_62 -> 3400, attr_63 -> 520, attr_60 -> 9810, attr_61 -> 3859, attr_68 -> 4355, attr_69 -> 8621, attr_70 -> 6857, attr_77 -> 9326, attr_78 -> 2908, attr_75 -> 446, attr_76 -> 2376, attr_73 -> 2957, attr_74 -> 9826, attr_71 -> 712, attr_72 -> 7359, attr_79 -> 298, attr_44 -> 8218, attr_45 -> 2731, attr_42 -> 7466, attr_43 -> 5602, attr_40 -> 2482, attr_41 -> 6798, attr_48 -> 2366, attr_49 -> 2059, attr_46 -> 9961, attr_47 -> 6591, attr_55 -> 5048, attr_56 -> 5415, attr_53 -> 5187, attr_54 -> 8649, attr_51 -> 8823, attr_52 -> 9093, attr_50 -> 5490, attr_9 -> 2639, attr_59 -> 9526, attr_8 -> 2023, attr_57 -> 4998, attr_7 -> 9428, attr_6 -> 7573, attr_58 -> 4488, attr_5 -> 7369, attr_4 -> 3792, attr_3 -> 4926, attr_2 -> 6811, attr_1 -> 1813, attr_0 -> 6151, attr_22 -> 4677, attr_23 -> 1136, attr_20 -> 4167, attr_21 -> 9044, attr_28 -> 5200, attr_29 -> 1817, attr_26 -> 4006, attr_27 -> 7902, attr_24 -> 405, attr_25 -> 9304, attr_33 -> 9662, attr_34 -> 8042, attr_31 -> 2085, attr_32 -> 197, attr_30 -> 3800, attr_39 -> 9407, attr_37 -> 7699, attr_38 -> 6469, attr_35 -> 7034, attr_36 -> 1390, attr_80 -> 1464, attr_81 -> 1098, attr_88 -> 5618, attr_89 -> 878, attr_86 -> 5763, attr_87 -> 8117, attr_84 -> 6003, attr_85 -> 3111, attr_82 -> 4868, attr_83 -> 1011, attr_91 -> 5564, attr_92 -> 4602, attr_90 -> 6991, attr_11 -> 7292, attr_99 -> 4077, attr_12 -> 4858, attr_97 -> 1677, attr_10 -> 5565, attr_98 -> 9544, attr_95 -> 7899, attr_96 -> 1067, attr_93 -> 7350, attr_94 -> 4735, attr_19 -> 9294, attr_17 -> 8620, attr_18 -> 3543, attr_15 -> 5665, attr_16 -> 9504, attr_13 -> 7784, attr_14 -> 828)
//  Object ID: 4, Attributes: Map(attr_66 -> 27, attr_67 -> 8388, attr_64 -> 4840, attr_65 -> 654, attr_62 -> 7125, attr_63 -> 5310, attr_60 -> 4943, attr_61 -> 9980, attr_68 -> 8798, attr_69 -> 1303, attr_70 -> 8742, attr_77 -> 9221, attr_78 -> 6469, attr_75 -> 279, attr_76 -> 1476, attr_73 -> 2021, attr_74 -> 5837, attr_71 -> 8970, attr_72 -> 1965, attr_79 -> 7741, attr_44 -> 5779, attr_45 -> 1277, attr_42 -> 5758, attr_43 -> 2187, attr_40 -> 2863, attr_41 -> 356, attr_48 -> 4046, attr_49 -> 4976, attr_46 -> 3697, attr_47 -> 8972, attr_55 -> 8337, attr_56 -> 9488, attr_53 -> 2693, attr_54 -> 5847, attr_51 -> 7852, attr_52 -> 8255, attr_50 -> 5855, attr_59 -> 7148, attr_9 -> 2443, attr_8 -> 894, attr_7 -> 9021, attr_57 -> 1198, attr_58 -> 449, attr_6 -> 3926, attr_5 -> 6042, attr_4 -> 3534, attr_3 -> 6175, attr_2 -> 165, attr_1 -> 5459, attr_0 -> 5237, attr_22 -> 2063, attr_23 -> 6723, attr_20 -> 1836, attr_21 -> 1316, attr_28 -> 1867, attr_29 -> 3017, attr_26 -> 3157, attr_27 -> 1304, attr_24 -> 8235, attr_25 -> 315, attr_33 -> 781, attr_34 -> 8961, attr_31 -> 6887, attr_32 -> 3976, attr_30 -> 2522, attr_39 -> 2525, attr_37 -> 7570, attr_38 -> 68, attr_35 -> 7510, attr_36 -> 9481, attr_80 -> 3238, attr_81 -> 4469, attr_88 -> 5965, attr_89 -> 9592, attr_86 -> 7105, attr_87 -> 7201, attr_84 -> 4987, attr_85 -> 5614, attr_82 -> 226, attr_83 -> 3685, attr_91 -> 9655, attr_92 -> 5597, attr_90 -> 3508, attr_99 -> 3794, attr_11 -> 5538, attr_12 -> 1475, attr_97 -> 3562, attr_98 -> 202, attr_10 -> 9076, attr_95 -> 1628, attr_96 -> 5554, attr_93 -> 4556, attr_94 -> 1952, attr_19 -> 8853, attr_17 -> 383, attr_18 -> 1406, attr_15 -> 6037, attr_16 -> 295, attr_13 -> 2269, attr_14 -> 1254)
//  Object ID: 5, Attributes: Map(attr_66 -> 4700, attr_67 -> 4565, attr_64 -> 6337, attr_65 -> 2467, attr_62 -> 2457, attr_63 -> 4832, attr_60 -> 7864, attr_61 -> 614, attr_68 -> 9248, attr_69 -> 9600, attr_70 -> 5882, attr_77 -> 2480, attr_78 -> 1279, attr_75 -> 881, attr_76 -> 3100, attr_73 -> 7042, attr_74 -> 6537, attr_71 -> 9803, attr_72 -> 7336, attr_79 -> 6728, attr_44 -> 9397, attr_45 -> 842, attr_42 -> 5154, attr_43 -> 4781, attr_40 -> 9261, attr_41 -> 4304, attr_48 -> 1150, attr_49 -> 1555, attr_46 -> 6158, attr_47 -> 6188, attr_55 -> 2296, attr_56 -> 781, attr_53 -> 3791, attr_54 -> 6007, attr_51 -> 4120, attr_52 -> 5340, attr_50 -> 7771, attr_9 -> 3310, attr_59 -> 865, attr_8 -> 2108, attr_57 -> 286, attr_7 -> 1254, attr_6 -> 1978, attr_58 -> 361, attr_5 -> 58, attr_4 -> 9213, attr_3 -> 3461, attr_2 -> 7508, attr_1 -> 358, attr_0 -> 6397, attr_22 -> 6474, attr_23 -> 8881, attr_20 -> 3479, attr_21 -> 4262, attr_28 -> 5754, attr_29 -> 878, attr_26 -> 2670, attr_27 -> 7063, attr_24 -> 6986, attr_25 -> 5446, attr_33 -> 9948, attr_34 -> 8515, attr_31 -> 1401, attr_32 -> 3953, attr_30 -> 6728, attr_39 -> 7381, attr_37 -> 5898, attr_38 -> 192, attr_35 -> 9019, attr_36 -> 2010, attr_80 -> 4371, attr_81 -> 5193, attr_88 -> 4388, attr_89 -> 694, attr_86 -> 5849, attr_87 -> 1325, attr_84 -> 4290, attr_85 -> 6284, attr_82 -> 8662, attr_83 -> 5940, attr_91 -> 6225, attr_92 -> 2600, attr_90 -> 6776, attr_99 -> 2218, attr_11 -> 342, attr_12 -> 8033, attr_97 -> 1655, attr_10 -> 4859, attr_98 -> 9722, attr_95 -> 804, attr_96 -> 8212, attr_93 -> 1683, attr_94 -> 5190, attr_19 -> 4730, attr_17 -> 1189, attr_18 -> 5520, attr_15 -> 3047, attr_16 -> 5754, attr_13 -> 2040, attr_14 -> 1618)
